{% extends 'bases/base.html' %}
  {% load static %}
  
{% block content %}
<h1>Cardápio</h1>
	{% if request.session.tipo_user|default:'' == 'gerente' or rrequest.session.tipo_user|default:'' == 'adm'%}
	<div class="dropdown">
        <button class=" dropdown-btn" id="dropdown1" ><i class = "uil uil-plus"></i>Adicionar Item</button>
        <div class="dropdown-content" id="dropdown-content1">
          <form method="POST" class="add" id="adicionar">
            {% csrf_token %}
			<input type="text" name="nome" placeholder="Nome">
			<input type="text" name="categoria" placeholder="Categoria">
			<input type="text" name="subcategoria" placeholder="Subcategoria">
			<input type="text" name="valor_venda" placeholder="Valor de Venda">
			<input type="text" name="descricao" placeholder="Descrição">
			<input type="text" name="img" placeholder="URL da Imagem">
            <button type="submit" name="adicionar"class="btn-table">
              <i class="uil uil-check"></i>
            </button>
          </form>  
        </div>
      </div>
	<!-- Formulário para adicionar combos -->
	  {% csrf_token %}
	  <div class="dropdown">
		<button class=" dropdown-btn" id="dropdown1" ><i class = "uil uil-plus"></i>Adicionar Combo</button>
        <div class="dropdown-content" id="dropdown-content1">
        	<form method="POST" class="add" id="adicionar">
		  	<input type="text" name="nome" placeholder="Nome do Combo">
		  	<input type="text" name="valor_item" placeholder="Valor do Combo">
		  	<select name="itens_combo" multiple>
				{% for categoria, itens_categoria in categorias.items %}
				{% for item in itens_categoria %}
					<option value="{{ item.nome }}">{{ item.nome }}</option>
				{% endfor %}
				{% endfor %}
			</select>
		  <input type="text" name="imagem_item" placeholder="URL da Imagem">
		  <button type="submit" name="action" value="adicionar_combo" class="btn-table">
			<i class="uil uil-check"></i>
		  </button>
		</div>
	  </div>
	</form>
	
	{% endif %}
  <div class="categories">
    {% for categoria, itens_categoria in categorias.items %}
      <div class="category">
        <h2>{{ categoria }}</h2>
        <div class="cards">
          {% for item in itens_categoria %}
            <div class="card">
              <img class="card_background" src="{{ item.img }}" alt="{{ item.nome }}" />
              <div class="card_content">
                <!-- Ícones de editar/excluir visíveis apenas para o gerente -->
				{% if request.session.tipo_user|default:'' == 'gerente' or rrequest.session.tipo_user|default:'' == 'adm'%}
				<div class="card_actions">
                    <button class="btn-table btn-circle">
                      <i class="uil uil-edit"></i>
                    </button>
                    <button type="submit" name="action" value="excluir" class="btn-table btn-circle">
                      <i class="uil uil-trash-alt"></i>
                    </button>
                  </div>
				  	{	% endif %}
                {% endif %}
                <h2 class="card_title">{{ item.nome }}</h2>
                <p>{{ item.descricao }}</p>
                <button class="btn-table">{{ item.valor }}<i class="uil uil-cart"></i></button>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    {% endfor %}
  </div>

  <script>
    // Código JavaScript para fazer o dropdown funcionar
    const dropdownBtns = document.querySelectorAll('.dropdown-btn');

    dropdownBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        btn.nextElementSibling.classList.toggle('show');
      });
    });
  </script>
{% endblock %}